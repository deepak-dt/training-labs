#Suhail
# When instance is spawn with two interface. The VM show only one working network interface. The second NIC exists, but not running.
#The issue is not with the OpenStack network configuration – it’s with the image. The image itself should be configured to work correctly with multiple NICs. All we have to do is bring up the NIC.
# Run below given command.

echo $'auto ens4\niface ens4 inet dhcp' | sudo tee /etc/network/interfaces.d/ens4.cfg > /dev/null 
sudo ifup ens4

# After second interface is up. When floating ip of second provider network is attached to interface. The instance will still not pingable.
# Reason: No roules in router to SNAT the packet from qg-* to 
# Solution:
# sudo ip netns exec qrouter-48d7f4a6-3e76-41a8-a83b-b5ea1e1b2cdf sudo vi /etc/sysctl.conf
# Uncomment net.ipv4.ip_forward = 1
# sudo ip netns exec qrouter-48d7f4a6-3e76-41a8-a83b-b5ea1e1b2cdf iptables -t nat -A POSTROUTING -o qg-be9785e0-ee -j SNAT --to 172.17.1.1[Internal network gateway]
#
# Issue related to ubuntu login
1. create a key-pair in openstack-dashboard
2. Download the key-pair file and place at any path on controller
3. Login using that file, for ex.
-> chmod 600 ubuntu-key-pair.pem
-> ssh -i ubuntu-key-pair.pem ubuntu@10.0.5.208



Points to note after setup bring-up
======================================
1. Bring-up tacker server process (ref: scripts/ubuntu/start_tacker_controller.sh)
2. Upload VNFDs and VNFFGD in tacker (ref: scripts/ubuntu/start_tacker_controller.sh)
3. Bring-up VNFs (i.e. DHCP, Firewall and vRouter). Wait for VNFs to come-up successfully
4. Check if there are multiple connection points in neutron/ports of ODL rest api, if yes then
 - In ODL-VM clear all context
    rm -rf data/ journal/ snapshots/
 - create a dummy network so that ODL refreshes its database. And check if there are "single" entries of CPs in 
    http://10.0.4.94:8080/controller/nb/v2/neutron/ports

5. Restart ODL karaf
6. Ensure that ping to all interfaces in VNFs in working fine. Wait till ping is working
7. Start ISS process in Firewall and vRouter VNFs and run ISS command script in ISS console
8. Deploy the VNFFG
9. Check if ODL puts in SFC flows on compute node. Command to check SFC flows:-
sudo ovs-ofctl dump-flows br-int -O openflow13 | grep "priority=6553"

10. Ping an external machine. If ping doesn't work:-
   - remove ip of interfaces of ISS VNFs FW(1,2) Router(1)
   - Put arp entries in FW-VNF and Vrouter VNF ISS console, if not already there in ISS script

